---
title: "Preminilary Graphs"
output:
  html_document: default
runtime: shiny
  
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

To begin please select the file you which to work with
```{r file_selection, echo=FALSE}

inputPanel(selectInput("season", h3("Select season"), 
              choices = list("Summer", "Winter"), selected = "Summer"))
conditionalPanel(
  condition = "input.season === Summer",
  selectInput("file", h3("Select date"), 
              choices = list("june 5 2018", "june 6 2018"), 
              selected = "june 5 2018")
  )
conditionalPanel(
  condition = "input.season === Winter",
  selectInput("file", h3("Select date"), 
              choices = list("jan 19 2018" , "jan 20 2018"), 
              selected = "jan 19 2018")
  )
           

#path <- paste("../data/raw_data/Silas Little Eddy Covariance Data/", 
            #  input$season, "2018 Datasets/raw sonic files/", input$file, sep="")


renderText(print(path))
```

## Histogram

```{r histogram, echo=FALSE}
#path <- "../data/raw_data/Silas Little Eddy Covariance Data/Winter 2018 Datasets/raw sonic files/"
filename <- "../data/raw_data/Silas Little Eddy Covariance Data/Winter 2018 Datasets/raw sonic files/jan 19 2018.csv"
#filename <- paste(path, filename, collapse = " ")
dta <- read.csv(filename, header= T);
inputPanel(
  selectInput("histogram", h3("Select box"), 
              choices = list("CO2", "u" , "v" , "w",
                              "airtemp"),
               selected = 1),
             
  sliderInput("bins", h3("number of bins"),
               min = 0, max = 100, value = 50)
)
      
renderPlot({
 switch(input$histogram,
        "CO2" = hist(dta$CO2, breaks = input$bins + 1,col = "#75AADB", border = "white"),
         "u" = hist(dta$u, breaks = input$bins + 1,col = "#75AADB", border = "white"),
         "v" = hist(dta$v, breaks = input$bins + 1,col = "#75AADB", border = "white"),
         "w" = hist(dta$w, breaks = input$bins + 1,col = "#75AADB", border = "white"),
         "airtemp" = hist(dta$airtemp, breaks = input$bins + 1,col = "#75AADB", border = "white"),
         )
})

```

## Plot vs Time

Now let's consider how these variable looks like when they are plotted against time.

```{r timeGraph, echo=FALSE}
inputPanel(
  checkboxGroupInput("wind_var", h3("Select Variables"), 
              choices = list( "vertical wind speed" = "u" , "horizontal wind speed1" = "v" , "horizontal wind speed2" ="w"),
               selected = "u"),
   selectInput("time_scale", h3("Select Time scale"), 
              choices = list("1/10th sec" = 1, "sec" = 2, "min" = 3, "hours"= 4),
               selected = 1)
)

 
renderPlot({
  col_val=c()
  var_data = c()
  col_list=c("blue", "red","black")
  for(i in 1:length(input$wind_var)){
    col_val = c(col_val, col_list[grep(input$wind_var[i], names(dta))])
    var_data = c(var_data, dta[grep(input$wind_var[i], names(dta))])
  }
  
  t<-seq(0,86400, length = 864001);
  var_data[[1]] = var_data[[1]][!is.na(var_data[[1]])]
  plot(t,  var_data[[1]], xlab="time(hours)", ylab = "wind", type="s",
            col=col_val[1])
  for(i in 1:length(var_data)){
    var_data[[i]] = var_data[[i]][!is.na(var_data[[i]])]
    lines(t,var_data[[i]], col=col_val[i])
  }
  
  legend("bottomright", input$wind_var, col=col_val, bg= "gray93")
})

renderPlot({
  par(mfrow=c(1,2),mar=c(4,4,4,1))
  CO2 <- dta$CO2[!is.na(dta$CO2)]
  airtemp <- dta$airtemp[!is.na(dta$airtemp)]
  t<-seq(0,86400, length = 864001);
  plot(t,  CO2, xlab="time(hours)", ylab = "CO2 umol-1", type="s", main = "CO2 vs time")
   plot(t,  airtemp, xlab="time(hours)", ylab = "Temp (C)", type="s", main = "Temp vs time")

})

```